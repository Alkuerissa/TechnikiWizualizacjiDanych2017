---
title: "Praca domowa 6"
author: Artur Minorczyk
output:
  html_document: default
  html_notebook: default
---

```{r, include=FALSE}
library(tibble)
library(dplyr)
library(purrr)
library(ggplot2)
library(RColorBrewer)
library(plotly)
```

Mapę kolorów przygotowano na podstawie palety Color Brewer.

```{r}
df <- brewer.pal.info %>%
  rownames_to_column("name") %>%
  rowid_to_column %>%
  mutate_if(is.factor, as.character) %>%
  pmap(function(rowid, name, maxcolors, category, colorblind) {
    codes <- brewer.pal(maxcolors, name)
    x_gap <- ifelse(category == "seq", 2, ifelse(category == "qual", 1, 0))
    data.frame(name = name, category = category, code = codes, x = rowid + x_gap, y = seq(length(codes)), 
               stringsAsFactors = FALSE)
  }) %>% bind_rows
```

```{r}
color_map <- ggplot(df) +
  geom_rect(aes(xmin = x - 0.5, xmax = x + 0.5, ymin = y - 0.5, ymax = y + 0.5, fill = code), colour = "grey80", size = 0.2) +
  geom_text(aes(x = x, y = 0, label = name), size = 4) +
  scale_fill_identity() +
  coord_flip() +
  theme(legend.position = "none",
        axis.text.x = element_blank(),
        axis.ticks.x = element_blank(),
        axis.title.x = element_blank(),
        axis.text.y = element_blank(),
        axis.ticks.y = element_blank(),
        axis.title.y = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(),
        panel.grid.minor.y = element_blank(),
        panel.grid.major.y = element_blank(),
        panel.background = element_blank())
```

```{r, fig.width=10, fig.height=8}
color_map
```

W raporcie nie umieszczam stworzonego wykresu przy pomocy plotly, ze względu na występujący w tej bibliotece błąd. W momencie gdy otworzy się taki wygenerowany wykres w przeglądarce Firefox, to zacznie ona zajmować sukcesywnie całą dostępną pamięć RAM. Przeglądarka Chrome natomiast nie ma tego problemu. Jednak żeby nie zabić komuś przez przypadek przeglądarki postanowiłem właśnie nie umieszczać interaktywnej wersji wykresu.

```{r, message=FALSE, eval = FALSE}
ggplotly(color_map, width = 900, height = 800)
```
